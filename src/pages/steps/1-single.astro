---
import Layout from '../../layouts/Layout.astro'
---

<Layout>
  <div class="image-stack">
    <img src="/01.webp" class="image-item" alt="image" />
  </div>
</Layout>

<style>
.image-stack {
  /* Center child image */
  display: flex;
  align-items: center;
  justify-content: center;

  /* Full screen */
  width: 100dvw;
  height: 100dvh;

  /* Optimize performance and prevent mobile scroll */
  contain: content;
}

.image-item {
  /* Overlap all images */
  position: absolute;

  /* Max Size Limit */
  width: auto;
  height: auto;
  max-width: min(800px, 80dvh, 95dvw);
  max-height: min(800px, 80dvh, 95dvw);

  /* 3D perspective effect and scale */
  transform: perspective(5000px) rotateX(-45deg) rotateY(-45deg) scale(0.33);
  transition: transform 0.5s cubic-bezier(0.645, 0.045, 0.355, 1);

  /* Cursor style */
  cursor: zoom-in;

  /* Optimize performance */
  backface-visibility: hidden;
  will-change: transform;
}

.image-item.zoomed {
  transform: perspective(800px) rotateX(0deg) rotateY(0deg) scale(1);
  cursor: zoom-out;
}
</style>

<script>
function handleClick(event: MouseEvent) {
  const target = event.target as HTMLElement

  // Find closest image and toggle zoom class
  target.closest('.image-item')?.classList.toggle('zoomed')
}

document.addEventListener('click', handleClick)
</script>
